<!-- Floating Handle -->
<button class="settings-handle" [class.handle-open]="isOpen" (click)="toggle()">
    <!-- <mat-icon aria-hidden="false" aria-label="Example home icon" fontIcon="home"></mat-icon> -->
    <!-- <mat-icon class="mat-icon-rtl-mirror">{{ 'settings' }}</mat-icon> -->
    <mat-icon>{{ isOpen ? 'chevron_right' : 'settings' }}</mat-icon>
</button>

<!-- Main Panel Drawer -->
<div class="settings-panel shadow-2xl" [class.open]="isOpen">
    <div class="settings-panel-header">
        <h3>Settings Panel</h3>
        <button mat-icon-button (click)="close()" class="close-btn" aria-label="Close">
            <mat-icon>close</mat-icon>
        </button>
    </div>

    <div class="settings-content custom-scrollbar">
        <!-- Layout Mode Section -->
        <div class="settings-group">
            <label class="group-label">Layout Mode</label>
            <div class="layout-grid">
                <div class="layout-option" [class.active]="layoutMode() === 'light'" (click)="setLayout('light')">
                    <div class="preview-card light">
                        <img src="/images/LightMode.png" alt="Light Mode Dashboard">
                    </div>
                    <div class="option-info">
                        <mat-icon>check_circle</mat-icon>
                        <span>Light Mode</span>
                    </div>
                </div>

                <div class="layout-option" [class.active]="layoutMode() === 'dark'" (click)="setLayout('dark')">
                    <div class="preview-card dark">
                        <img src="/images/DarkMode.png" alt="Dark Mode Dashboard">
                    </div>
                    <div class="option-info">
                        <mat-icon>check_circle</mat-icon>
                        <span>Dark Mode</span>
                    </div>
                </div>
            </div>
        </div>



        <!-- Sidebar Color Segment -->
        <div class="settings-group">
            <label class="group-label">Sidebar Color</label>
            <mat-button-toggle-group [value]="sidenavColor()" (change)="setSidenavColor($event.value)" exclusive>
                <mat-button-toggle value="light" class="toggle-light">
                    <mat-icon>light_mode</mat-icon> Light
                </mat-button-toggle>
                <mat-button-toggle value="dark" class="toggle-dark">
                    <mat-icon>dark_mode</mat-icon> Dark
                </mat-button-toggle>
            </mat-button-toggle-group>
        </div>

        <!-- Density Selection -->
        <div class="settings-group">
            <label class="group-label">Interface Density</label>
            <mat-button-toggle-group [value]="density()" (change)="setDensity($event.value)" exclusive>
                <mat-button-toggle value="compact" matTooltip="Compact View">
                    <mat-icon>density_small</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle value="default" matTooltip="Normal View">
                    <mat-icon>density_medium</mat-icon>
                </mat-button-toggle>
                <mat-button-toggle value="expanded" matTooltip="Large View">
                    <mat-icon>density_large</mat-icon>
                </mat-button-toggle>
            </mat-button-toggle-group>
        </div>

        <!-- Brand Color Grid -->
        <div class="settings-group">
            <label class="group-label">Brand Color Accent</label>
            <div class="color-grid">
                @for (color of themeColors; track color.hex) {
                <button class="color-btn" [style.background-color]="color.hex"
                    [class.selected]="currentPrimaryColor === color.hex" (click)="setThemeColor(color.hex)">
                    @if (currentPrimaryColor === color.hex) {
                    <mat-icon>done</mat-icon>
                    }
                </button>
                }
            </div>
        </div>
    </div>

    <!-- Footer Actions -->
    <div class="settings-footer">
        <button class="reset-btn" (click)="resetDefaults()" matRipple>
            <mat-icon>restart_alt</mat-icon>
            Restore Defaults
        </button>
    </div>
</div>

<!-- Overlay Backdrop -->
@if (isOpen) {
<div class="settings-backdrop" (click)="close()"></div>
}