<ul class="matero-sidemenu level-0" [class.sidemenu-collapsed]="isCollapsed()">
    <ng-container *ngTemplateOutlet="menuRecursive; context: { $implicit: menuItems, level: 0 }"></ng-container>
</ul>

<!-- ðŸŒ³ Recursive Menu Template -->
<ng-template #menuRecursive let-items let-level="level">
    @for (item of items; track item.id) {
    <li class="menu-item" [class.active]="isActiveRoute(item.route)" [class.expanded]="isOpen(item.id)"
        [class.is-collapsed]="isCollapsed()">

        <!-- Type: LINK -->
        @if (item.type === 'link') {
        <a class="menu-heading" [routerLink]="item.route" routerLinkActive="active" (click)="onMenuItemClick()"
            [class.is-collapsed]="isCollapsed()" [style.padding-left.px]="isCollapsed() ? 0 : 16 + (level * 16)">
            @if (item.icon) {
            <mat-icon class="menu-icon">{{ item.icon }}</mat-icon>
            }
            @if (!isCollapsed()) {
            <span class="menu-name">{{ item.label | translate }}</span>
            }
        </a>
        }

        <!-- Type: GROUP or SUB (Expandable) -->
        @else if (item.type === 'group' || item.type === 'sub') {
        @if (isCollapsed()) {
        <div class="collapsed-group-icon">
            @if (item.icon) {
            <mat-icon>{{ item.icon }}</mat-icon>
            }
        </div>
        } @else {
        <button class="menu-heading menu-toggle" (click)="toggleMenu(item)" [style.padding-left.px]="16 + (level * 16)">
            @if (item.icon) {
            <mat-icon class="menu-icon">{{ item.icon }}</mat-icon>
            }
            <span class="menu-name">{{ item.label | translate }}</span>
            <mat-icon class="menu-caret">expand_more</mat-icon>
        </button>

        @if (item.children) {
        <ul class="matero-sidemenu level-{{ level + 1 }}" [@expansion]="isOpen(item.id) ? 'expanded' : 'collapsed'"
            style="overflow: hidden; display: block;">
            <ng-container *ngTemplateOutlet="menuRecursive; context: { $implicit: item.children, level: level + 1 }">
            </ng-container>
        </ul>
        }
        }
        }
    </li>
    }
</ng-template>
<br />