:host {
    display: inline-block;
    vertical-align: middle;

    &.ui-button--full-width {
        display: block;
        width: 100%;

        .ui-button__control {
            width: 100%;
        }
    }
}

.ui-button__control {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--ui-space-xs, 0.5rem);

    // Use tokens with fallbacks
    border-radius: var(--ui-radius-base, 8px);
    border-width: var(--ui-border-width-base, 1px);
    border-style: var(--ui-border-style-base, solid);
    border-color: transparent;

    font-family: var(--ui-font-family-sans, inherit);
    font-weight: var(--ui-font-weight-medium, 500);
    line-height: 1.5;
    letter-spacing: 0.01em;

    cursor: pointer;
    overflow: hidden;
    user-select: none;

    // High-performance transitions
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);

    &:focus-visible {
        outline: none;
        box-shadow: 0 0 0 3px var(--ui-color-focus-ring, rgba(59, 130, 246, 0.5));
    }

    &:disabled {
        cursor: not-allowed;
        opacity: 0.35; // Softer gray for disabled state
        pointer-events: none;
        filter: grayscale(1); // Ensure no brand color bleeds through
    }
}

/* --- Variants --- */

:host(.ui-button--primary) .ui-button__control {
    background-color: var(--ui-color-primary, #2563eb);
    color: var(--ui-color-on-primary, #ffffff);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1),
        0 4px 6px -1px rgba(37, 99, 235, 0.2); // Colored shadow

    &:hover:not(:disabled) {
        background-color: var(--ui-color-primary-hover, #1d4ed8);
        box-shadow: 0 10px 25px -5px rgba(37, 99, 235, 0.5),
            0 8px 10px -6px rgba(0, 0, 0, 0.1);
    }

    &:active:not(:disabled) {
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }
}

:host(.ui-button--secondary) .ui-button__control {
    background-color: var(--ui-color-secondary, #f3f4f6);
    color: var(--ui-color-on-secondary, #1f2937);
    border-color: var(--ui-color-secondary, #f3f4f6);

    &:hover:not(:disabled) {
        background-color: var(--ui-color-secondary-hover, #e5e7eb);
        border-color: var(--ui-color-secondary-hover, #e5e7eb);
        box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.12),
            0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    &:active:not(:disabled) {
        background-color: var(--ui-color-secondary-active, #d1d5db);
    }
}

:host(.ui-button--outline) .ui-button__control {
    background-color: transparent;
    border-color: var(--ui-color-border, #d1d5db);
    color: var(--ui-color-text, #374151);

    &:hover:not(:disabled) {
        background-color: var(--ui-color-bg-hover, #f9fafb);
        border-color: var(--ui-color-border-hover, #9ca3af);
        box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.1),
            0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    &:active:not(:disabled) {
        background-color: var(--ui-color-bg-active, #f3f4f6);
    }
}

:host(.ui-button--ghost) .ui-button__control {
    background-color: transparent;
    color: var(--ui-color-text, #374151);

    &:hover:not(:disabled) {
        background-color: var(--ui-color-bg-hover, rgba(0, 0, 0, 0.05));
        box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.08);
    }

    &:active:not(:disabled) {
        background-color: var(--ui-color-bg-active, rgba(0, 0, 0, 0.1));
    }
}

:host(.ui-button--danger) .ui-button__control {
    background-color: var(--ui-color-danger, #ef4444);
    color: var(--ui-color-on-danger, #ffffff);

    &:hover:not(:disabled) {
        background-color: var(--ui-color-danger-hover, #dc2626);
        box-shadow: 0 10px 25px -5px rgba(239, 68, 68, 0.5),
            0 8px 10px -6px rgba(0, 0, 0, 0.1);
    }

    &:active:not(:disabled) {
        background-color: var(--ui-color-danger-active, #b91c1c);
    }
}

/* --- Sizes --- */

:host(.ui-button--sm) .ui-button__control {
    height: 2rem; // 32px
    padding-inline: 0.75rem;
    font-size: 0.8125rem; // 13px
}

:host(.ui-button--md) .ui-button__control {
    height: 2.5rem; // 40px
    padding-inline: 1rem;
    font-size: 0.875rem; // 14px
}

:host(.ui-button--lg) .ui-button__control {
    height: 3rem; // 48px
    padding-inline: 1.5rem;
    font-size: 1rem; // 16px
}

:host(.ui-button--xl) .ui-button__control {
    height: 3.5rem; // 56px
    padding-inline: 2rem;
    font-size: 1.125rem; // 18px
}

/* --- Loading Spinner --- */

.ui-button__spinner-wrapper {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
}

.ui-button__spinner {
    animation: rotate 2s linear infinite;
    width: 1.25em;
    height: 1.25em;

    & .path {
        stroke: currentColor;
        stroke-linecap: round;
        animation: dash 1.5s ease-in-out infinite;
    }
}

@keyframes rotate {
    100% {
        transform: rotate(360deg);
    }
}

@keyframes dash {
    0% {
        stroke-dasharray: 1, 150;
        stroke-dashoffset: 0;
    }

    50% {
        stroke-dasharray: 90, 150;
        stroke-dashoffset: -35;
    }

    100% {
        stroke-dasharray: 90, 150;
        stroke-dashoffset: -124;
    }
}

.ui-button__content {
    display: inline-flex;
    align-items: center;
    gap: inherit;
    transition: opacity 0.2s;

    &--hidden {
        opacity: 0;
    }
}