<mat-sidenav-container class="ui-sidenav-container" (backdropClick)="onBackdropClick()"
    [attr.aria-label]="i18n?.ariaLabel">
    <mat-sidenav #sidenav [mode]="mode" [opened]="opened" class="ui-sidenav"
        [class.ui-sidenav--expanded]="state === 'expanded'"
        [class.ui-sidenav--collapsed]="state === 'collapsed' && mode === 'side'" (closed)="onClosed()">

        <div class="ui-sidenav-header">
            <ng-content select="[header]">
            </ng-content>
        </div>

        <nav class="ui-sidenav-content" [attr.aria-label]="i18n?.ariaLabel || 'Main navigation'">
            @for (item of items; track item.id) {
            <div class="ui-sidenav-item-group">
                <a class="ui-sidenav-item" [class.ui-sidenav-item--active]="activeItemId === item.id"
                    [class.ui-sidenav-item--disabled]="item.disabled"
                    [class.ui-sidenav-item--expanded]="isExpanded(item.id)" (click)="onItemClick(item)"
                    [attr.aria-label]="item.label" [attr.title]="state === 'collapsed' ? item.label : null">
                    <mat-icon class="ui-sidenav-item__icon">{{ item.icon }}</mat-icon>
                    <span class="ui-sidenav-item__label">{{ item.label }}</span>

                    @if (item.children && item.children.length > 0 && state === 'expanded') {
                    <mat-icon class="ui-sidenav-item__chevron">
                        {{ isExpanded(item.id) ? 'expand_less' : 'expand_more' }}
                    </mat-icon>
                    }

                    @if (item.badge && state === 'expanded' && (!item.children || item.children.length === 0)) {
                    <span class="ui-sidenav-item__badge">
                        <span class="ui-badge ui-badge--{{ item.badgeColor || 'primary' }}">{{ item.badge }}</span>
                    </span>
                    }
                </a>

                @if (item.children && item.children.length > 0 && isExpanded(item.id) && state === 'expanded') {
                <div class="ui-sidenav-submenu">
                    @for (child of item.children; track child.id) {
                    <a class="ui-sidenav-item ui-sidenav-item--child"
                        [class.ui-sidenav-item--active]="activeItemId === child.id"
                        [class.ui-sidenav-item--disabled]="child.disabled" (click)="onItemClick(child)">
                        <mat-icon class="ui-sidenav-item__icon">{{ child.icon }}</mat-icon>
                        <span class="ui-sidenav-item__label">{{ child.label }}</span>
                        @if (child.badge) {
                        <span class="ui-sidenav-item__badge">
                            <span class="ui-badge ui-badge--{{ child.badgeColor || 'primary' }}">{{ child.badge
                                }}</span>
                        </span>
                        }
                    </a>
                    }
                </div>
                }
            </div>
            }
        </nav>

        <div class="ui-sidenav-footer">
            <ng-content select="[footer]"></ng-content>
        </div>
    </mat-sidenav>

    <mat-sidenav-content>
        <ng-content></ng-content>
    </mat-sidenav-content>
</mat-sidenav-container>